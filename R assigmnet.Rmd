---
title: "R assigmnet"
author: "yajur sehra"
date: "2023-08-16"
output: html_document
---


```{r} 
getwd()
library(tidyverse)
library(ggplot2)
library(dplyr)


#Pizza supply chain optimization and demand forecast

#part a

fixed_cost <- 1000
cost_plain_cheese <- 4.50
cost_veggie_cheese <- 5.00
selling_price <- 9.00

demand_plain_cheese <- c(200, 300, 400, 500, 600, 700, 800, 800)
prob_plain_cheese <- c(0.10, 0.15, 0.10, 0.20, 0.20, 0.10, 0.05, 0.05)

demand_veggie_cheese <- c(300, 400, 500, 600, 700, 800)
prob_veggie_cheese <- c(0.10, 0.20, 0.25, 0.25, 0.15, 0.05)

# Create empty data frames to store results
result_plain_cheese <- data.frame(demand = demand_plain_cheese)
result_veggie_cheese <- data.frame(demand = demand_veggie_cheese)

# Calculate profit for plain cheese pizzas
for (production in demand_plain_cheese) {
  profit <- (min(production, demand_plain_cheese) * selling_price) - 
            ((production * cost_plain_cheese) + (fixed_cost / 2))
  result_plain_cheese[, as.character(production)] <- profit * prob_plain_cheese
}

# Calculate profit for veggie-and-cheese combo pizzas
for (production in demand_veggie_cheese) {
  profit <- (min(production, demand_veggie_cheese) * selling_price) - 
            ((production * cost_veggie_cheese) + (fixed_cost / 2))
  result_veggie_cheese[, as.character(production)] <- profit * prob_veggie_cheese
}

# Print the two-way data tables
print("Plain Cheese Pizza Profit Table:")
print(result_plain_cheese)

print("Veggie-and-Cheese Combo Pizza Profit Table:")
print(result_veggie_cheese)

#part b



# Calculate expected profit for plain cheese pizzas
expected_profit_plain_cheese <- numeric(length(demand_plain_cheese))

for (i in seq_along(demand_plain_cheese)) {
  production <- demand_plain_cheese[i]
  profit <- (min(production, demand_plain_cheese) * selling_price) -
            ((production * cost_plain_cheese) + (fixed_cost / 2))
  expected_profit_plain_cheese[i] <- sum(profit * prob_plain_cheese)
}

# Calculate expected profit for veggie-and-cheese combo pizzas
expected_profit_veggie_cheese <- numeric(length(demand_veggie_cheese))

for (i in seq_along(demand_veggie_cheese)) {
  production <- demand_veggie_cheese[i]
  profit <- (min(production, demand_veggie_cheese) * selling_price) -
            ((production * cost_veggie_cheese) + (fixed_cost / 2))
  expected_profit_veggie_cheese[i] <- sum(profit * prob_veggie_cheese)
}

# Print the vectors of expected profits
print("Expected Profit Vector for Plain Cheese Pizza:")
print(expected_profit_plain_cheese)

print("Expected Profit Vector for Veggie-and-Cheese Combo Pizza:")
print(expected_profit_veggie_cheese)

#partc

max_expected_profit_plain_cheese <- which.max(expected_profit_plain_cheese)
max_expected_profit_veggie_cheese <- which.max(expected_profit_veggie_cheese)

# Determine the corresponding production levels that maximize the expected profit
production_plain_cheese <- demand_plain_cheese[max_expected_profit_plain_cheese]
production_veggie_cheese <- demand_veggie_cheese[max_expected_profit_veggie_cheese]

# Print the results
print("To maximize expected profit:")
cat("Produce", production_plain_cheese, "Plain Cheese Pizzas\n")
cat("Produce", production_veggie_cheese, "Veggie-and-Cheese Combo Pizzas\n")



```








